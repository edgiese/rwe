<?php
// styler for font face.  set by css
// writes styles for:  
class style_font extends style_base {
	private $initstring;
		
	function __construct($initstring) {
		if ($initstring == "")
			$initstring="basic_sans_serif";		// default
		$this->initstring=$initstring;		
	}

	static function isRequired($html) {
		return False === array_search($html,array("body","div","img","hr"));
	}

	private function getFacenameArrays() {
		$msfonts=array(
			001=>array(001,"Microsoft Sans Serif",99.58),
			002=>array(002,"Arial Black",97.78),
			003=>array(003,"Palatino Linotype",97.59),
			004=>array(004,"Franklin Gothic Medium",97.55),
			005=>array(005,"Verdana",97.46),
			006=>array(006,"Arial",97.04),
			007=>array(007,"Courier New",96.86),
			008=>array(008,"Comic Sans MS",96.75),
			009=>array(009,"Lucida Console",96.72),
			010=>array(010,"Tahoma",96.68),
			011=>array(011,"Impact",96.40),
			012=>array(012,"Trebuchet MS",95.87),
			013=>array(013,"Sylfaen",95.27),
			014=>array(014,"Lucida Sans Unicode",94.22),
			015=>array(015,"Georgia",92.77),
			016=>array(016,"Times New Roman",87.58),
			017=>array(017,"Arial Narrow",87.34),
			018=>array(018,"Century Gothic",85.82),
			019=>array(019,"Bookman Old Style",84.34),
			020=>array(020,"Book Antiqua",83.92),
/*			021=>array(021,"Vrinda",83.53), 
			022=>array(022,"Kartika",83.36),
			023=>array(023,"Monotype Corsiva",82.48),
			024=>array(024,"Garamond",79.54),
			025=>array(025,"Haettenschweiler",69.91),
			026=>array(026,"MS Reference Sans Serif",67.74),
			027=>array(027,"Bradley Hand ITC",59.71),
			028=>array(028,"Papyrus",59.63),
			029=>array(029,"French Script MT",59.04),
			030=>array(030,"Tempus Sans ITC",58.87),
			031=>array(031,"Copperplate Gothic Light",58.11),
			032=>array(032,"Perpetua",57.77),
			033=>array(033,"Franklin Gothic Book",57.69),
			034=>array(034,"Curlz MT",57.60),
			035=>array(035,"Franklin Gothic Medium Cond",57.43),
			036=>array(036,"Edwardian Script ITC",57.35),
			037=>array(037,"Kristen ITC",57.18),
			038=>array(038,"Franklin Gothic Demi",57.09),
			039=>array(039,"Felix Titling",57.01),
			040=>array(040,"Mistral",57.01),
			041=>array(041,"Maiandra GD",56.93),
			042=>array(042,"Rockwell Extra Bold",56.93),
			043=>array(043,"Engravers MT",56.84),
			044=>array(044,"Eras Demi ITC",56.84),
			045=>array(045,"Eras Light ITC",56.76),
			046=>array(046,"Blackadder ITC",56.50),
			047=>array(047,"Rockwell",55.74),
			048=>array(048,"Juice ITC",55.57),
			049=>array(049,"Franklin Gothic Demi Cond",55.07),
			050=>array(050,"Franklin Gothic Heavy",54.98),
			051=>array(051,"Vivaldi",54.81),
			052=>array(052,"Copperplate Gothic Bold",54.64),
			053=>array(053,"Jokerman",53.21),
			054=>array(054,"Pristina",52.79),
			055=>array(055,"Arial Unicode MS",51.32),
			056=>array(056,"Freestyle Script",50.68),
			057=>array(057,"Calisto MT",50.51),
			058=>array(058,"Script MT Bold",50.00),
			059=>array(059,"Imprint MT Shadow",49.58),
			060=>array(060,"Gill Sans Ultra Bold",49.41),
			061=>array(061,"Palace Script MT",49.16),
			062=>array(062,"Castellar",48.99),
			063=>array(063,"Gill Sans MT",48.99),
			064=>array(064,"Goudy Stout",48.99),
			065=>array(065,"Goudy Old Style",48.83),
			066=>array(066,"Gill Sans MT Condensed",48.48),
			067=>array(067,"Rage Italic",48.48),
			068=>array(068,"Agency FB",48.40),
			069=>array(069,"Forte",48.31),
			070=>array(070,"OCR A Extended",48.25),
			071=>array(071,"Eras Medium ITC",48.14),
			072=>array(072,"Eras Bold ITC",48.06),
			073=>array(073,"Gigi",48.06),
			074=>array(074,"Perpetua Titling MT",48.06),
			075=>array(075,"Gill Sans MT Ext Condensed Bold",47.89),
			076=>array(076,"Viner Hand ITC",47.89),
			077=>array(077,"Rockwell Condensed",47.80),
			078=>array(078,"Gill Sans Ultra Bold Condensed",47.72),
			079=>array(079,"Tw Cen MT Condensed",47.55),
			080=>array(080,"Tw Cen MT",47.47),
			081=>array(081,"Lucida Calligraphy",47.38),
			082=>array(082,"Tw Cen MT Condensed Extra Bold",47.38),
			083=>array(083,"Arial Rounded MT Bold",47.37),
			084=>array(084,"Cooper Black",47.30),
			085=>array(085,"Gloucester MT Extra Condensed",47.30),
			086=>array(086,"Century Schoolbook",47.20),
			087=>array(087,"Broadway",47.13),
			088=>array(088,"Wide Latin",47.13),
			089=>array(089,"Algerian",46.88),
			090=>array(090,"Brush Script MT",46.88),
			091=>array(091,"Snap ITC",46.88),
			092=>array(092,"Britannic Bold",46.79),
			093=>array(093,"Playbill",46.71),
			094=>array(094,"Bauhaus 93",46.62),
			095=>array(095,"Harrington",46.62),
			096=>array(096,"Onyx",46.62),
			097=>array(097,"Bernard MT Condensed",46.54),
			098=>array(098,"Baskerville Old Face",46.45),
			099=>array(099,"Chiller",46.45),
			100=>array(100,"Matura MT Script Capitals",46.45),
			101=>array(101,"Old English Text MT",46.37),
			102=>array(102,"Lucida Handwriting",46.21),
			103=>array(103,"Harlow Solid Italic",46.11),
			104=>array(104,"Vladimir Script",46.11),
			105=>array(105,"Informal Roman",45.95),
			106=>array(106,"Kunstler Script",45.95),
			107=>array(107,"Stencil",45.44),
			108=>array(108,"Footlight MT Light",45.35),
			109=>array(109,"Bell MT",45.19),
			110=>array(110,"Bodoni MT Condensed",44.93),
			111=>array(111,"Centaur",44.93),
			112=>array(112,"Bodoni MT",44.85),
			113=>array(113,"Bodoni MT Black",44.85),
			114=>array(114,"Colonna MT",44.68),
			115=>array(115,"Showcard Gothic",44.51),
			116=>array(116,"High Tower Text",44.43),
			117=>array(117,"Californian FB",44.34),
			118=>array(118,"Berlin Sans FB",44.26),
			119=>array(119,"Ravie",44.26),
			120=>array(120,"Niagara Engraved",43.92),
			121=>array(121,"Niagara Solid",43.83),
			122=>array(122,"Calibri",43.61),
			123=>array(123,"Berlin Sans FB Demi",43.50),
			124=>array(124,"Magneto",43.33),
			125=>array(125,"Consolas",43.30),
			126=>array(126,"Cambria",43.22),
			127=>array(127,"Candara",43.07),
			128=>array(128,"Corbel",42.91),
			129=>array(129,"Lucida Fax",42.65),
			130=>array(130,"Constantia",42.37),
			131=>array(131,"Bodoni MT Poster Compressed",41.81),
			132=>array(132,"Segoe UI",35.44),
			133=>array(133,"Terminal",30.19),
			134=>array(134,"Bitstream Vera Sans Mono",29.31),
			135=>array(135,"Bitstream Vera Sans",25.25),
			136=>array(136,"Bitstream Vera Serif",25.08),
			137=>array(137,"Eurostile",21.28),
			138=>array(138,"Matisse ITC",20.19),
			139=>array(139,"Staccato222 BT",13.98),
			140=>array(140,"Abadi MT Condensed Light",13.16),
			141=>array(141,"Lucida Bright",12.50),
			142=>array(142,"Baby Kruffy",11.91),
			143=>array(143,"Alba Super",11.15),
			144=>array(144,"Alba",10.81),
			145=>array(145,"Alba Matter",10.73),
			146=>array(146,"Braggadocio",10.62),
			147=>array(147,"Frosty",10.22),
			148=>array(148,"Lucida Sans",10.16),
			149=>array(149,"Broadway BT",10.09),
			150=>array(150,"Chick",10.05),
			151=>array(151,"Weltron Urban",9.88),
			152=>array(152,"Calligraph421 BT",9.66),
			153=>array(153,"Croobie",9.54),
			154=>array(154,"Freshbot",9.54),
			155=>array(155,"Pussycat",9.46),
			156=>array(156,"Fat",9.38),
			157=>array(157,"Jenkins 2.0",9.38),
			158=>array(158,"GlooGun",9.29),
			159=>array(159,"Jokewood",9.29),
			160=>array(160,"Square721 BT",9.23),
			161=>array(161,"Poornut",9.12),
			162=>array(162,"MisterEarl BT",9.04),
			163=>array(163,"Blackletter686 BT",8.97),
			164=>array(164,"Cataneo BT",8.97),
			165=>array(165,"ParkAvenue BT",8.89),
			166=>array(166,"John Handy LET",7.77),
			167=>array(167,"Rage Italic LET",7.68),
			168=>array(168,"OldDreadfulNo7 BT",7.59),
			169=>array(169,"Scruff LET",7.59),
			170=>array(170,"Westwood LET",7.59),
			171=>array(171,"La Bamba LET",7.51),
			172=>array(172,"Mekanik LET",7.51),
			173=>array(173,"Ruach LET",7.51),
			174=>array(174,"Milano LET",7.42),
			175=>array(175,"One Stroke Script LET",7.42),
			176=>array(176,"Tiranti Solid LET",7.42),
			177=>array(177,"Desdemona",7.34),
			178=>array(178,"Helvetica",7.26),
			179=>array(179,"Jokerman LET",7.16),
			180=>array(180,"Pump Demi Bold LET",7.16),
			181=>array(181,"Smudger LET",7.16),
			182=>array(182,"University Roman LET",7.16),
			183=>array(183,"Victorian LET",7.16),
			184=>array(184,"Highlight LET",7.08),
			185=>array(185,"Orange LET",7.08),
			186=>array(186,"Academy Engraved LET",6.99),
			187=>array(187,"Quixley LET",6.99),
			188=>array(188,"Odessa LET",6.90),
			189=>array(189,"Verdana Ref",6.21),
			190=>array(190,"Univers",6.08),
			191=>array(191,"Kabel Ult BT",6.04),
			192=>array(192,"Lucida Sans Typewriter",5.86),
			193=>array(193,"Andale Mono IPA",4.75),
			194=>array(194,"Helvetica Narrow",4.65),
			195=>array(195,"Beesknees ITC",4.57),
			196=>array(196,"Georgia Ref",4.40),
			197=>array(197,"Times",4.31),
			198=>array(198,"Kino MT",4.22),
			199=>array(199,"Abadi MT Condensed Extra Bold",4.14),
			200=>array(200,"MS Reference Serif",4.06),
			201=>array(201,"News Gothic MT",3.89),
			202=>array(202,"Palatino",3.72),
			203=>array(203,"Pepita MT",3.54),
			204=>array(204,"New Century Schoolbook",3.46),
			205=>array(205,"Andale Mono",3.29),
			206=>array(206,"Abadi MT Condensed",3.28),
			207=>array(207,"Andy",3.28),
			208=>array(208,"OCRB",3.19),
			209=>array(209,"Optima",3.13),
			210=>array(210,"Placard Condensed",3.11),
			211=>array(211,"GENUINE",2.85),
			212=>array(212,"Bickley Script",2.67),
			213=>array(213,"Fine Hand",2.59),
			214=>array(214,"Runic MT Condensed",2.59),
			215=>array(215,"Gill Sans",2.53),
			216=>array(216,"Monaco",2.36),
			217=>array(217,"Chicago",2.11),
			218=>array(218,"DomBold BT",2.07),
			219=>array(219,"Geneva",2.03),
			220=>array(220,"Base 02",1.90),
			221=>array(221,"A Charming Font",1.73),
			222=>array(222,"CAMPBELL",1.73),
			223=>array(223,"Apple Chancery",1.69),
			224=>array(224,"New York",1.69),
			225=>array(225,"MARKETPRO",1.55),
			226=>array(226,"Mercurius Script MT Bold",1.55),
			227=>array(227,"Helvetica Neue",1.52),
			228=>array(228,"BudHand",1.38),
			229=>array(229,"Futura",1.35),
			230=>array(230,"Hoefler Text",1.27),
			231=>array(231,"Monotype.com",1.01),
			232=>array(232,"FIRSTHOME",0.86),
			233=>array(233,"Mead Bold",0.69),
			234=>array(234,"04b_21",0.60),
			235=>array(235,"Champignon",0.26),
			236=>array(236,"Gadget",0.17),      */
			237=>array(237,"Minion Web",0.17)
		); 
		 
		$applefonts=array(
			000=>array(000,"Monaco",96.77),
			001=>array(001,"Arial",96.48),
			002=>array(002,"Courier",96.33),
			003=>array(003,"Helvetica",96.33),
			004=>array(004,"Arial Black",95.74),
			005=>array(005,"Verdana",94.13),
			006=>array(006,"Helvetica Neue",93.60),
			007=>array(007,"Georgia",93.54),
			008=>array(008,"Trebuchet MS",92.36),
			009=>array(009,"Geneva",92.22),
			010=>array(010,"Courier New",91.92),
			011=>array(011,"Comic Sans MS",91.34),
			012=>array(012,"Arial Narrow",90.75),
			013=>array(013,"Gill Sans",90.70),
			014=>array(014,"Times New Roman",90.31),
			015=>array(015,"Apple Chancery",89.87),
			016=>array(016,"Skia",89.72),
			017=>array(017,"Futura",89.57),
			018=>array(018,"Lucida Grande",89.57),
			019=>array(019,"Hoefler Text",88.40),
			020=>array(020,"Times",88.11),
			021=>array(021,"Impact",87.96),
/*			022=>array(022,"Arial Rounded MT Bold",87.67),
			023=>array(023,"Optima",87.52),
			024=>array(024,"Baskerville",87.21),
			025=>array(025,"American Typewriter",87.13),
			026=>array(026,"Didot",86.05),
			027=>array(027,"Marker Felt",85.47),
			028=>array(028,"Zapfino",85.47),
			029=>array(029,"Copperplate",85.46),
			030=>array(030,"Andale Mono",85.17),
			031=>array(031,"Brush Script MT",85.02),
			032=>array(032,"Papyrus",84.85),
			033=>array(033,"Herculanum",79.55),
			034=>array(034,"Big Caslon",78.79),
			035=>array(035,"Palatino",78.71),
			036=>array(036,"Tahoma",72.54),
			037=>array(037,"New York",59.03),
			038=>array(038,"Charcoal",57.56),
			039=>array(039,"Chicago",57.12),
			040=>array(040,"Gadget",54.19),
			041=>array(041,"Capitals",40.15),
			042=>array(042,"Century Gothic",38.64),
			043=>array(043,"Copperplate Gothic Bold",29.55),
			044=>array(044,"Lucida Handwriting",29.55),
			045=>array(045,"Bitstream Vera Sans Mono",22.73),
			046=>array(046,"Bitstream Vera Sans",21.21),
			047=>array(047,"Bitstream Vera Serif",21.21),
			048=>array(048,"Lucida Bright",20.45),
			049=>array(049,"Lucida Sans",20.45),
			050=>array(050,"Lucida Sans Typewriter",20.45),
			051=>array(051,"Century Schoolbook",18.18),
			052=>array(052,"Textile",17.42),
			053=>array(053,"Sand",15.91),
			054=>array(054,"Techno",15.91),
			055=>array(055,"Univers",14.62),
			056=>array(056,"Bookman Old Style",13.64),
			057=>array(057,"Garamond",12.88),
			058=>array(058,"Book Antiqua",10.61),
			059=>array(059,"Footlight MT Light",10.61),
			060=>array(060,"Goudy Old Style",10.61),
			061=>array(061,"Monotype Corsiva",9.85),
			062=>array(062,"News Gothic MT",9.85),
			063=>array(063,"Britannic Bold",9.09),
			064=>array(064,"Colonna MT",9.09),
			065=>array(065,"Consolas",9.09),
			066=>array(066,"Haettenschweiler",9.09),
			067=>array(067,"Playbill",9.09),
			068=>array(068,"Abadi MT Condensed Light",8.33),
			069=>array(069,"Calisto MT",8.33),
			070=>array(070,"Matura MT Script Capitals",8.33),
			071=>array(071,"Calibri",7.58),
			072=>array(072,"Cambria",7.58),
			073=>array(073,"Constantia",7.58),
			074=>array(074,"Corbel",7.58),
			075=>array(075,"Desdemona",7.58),
			076=>array(076,"Wide Latin",7.58),
			077=>array(077,"Braggadocio",6.82),
			078=>array(078,"Candara",6.82),
			079=>079=>array(079,"Kino MT",6.06),
			080=>080=>array(080,"Avant Garde",3.79),
			081=>array(081,"Bookman",3.03),
			082=>array(082,"New Century Schoolbook",3.03),
			083=>array(083,"Minion Web",2.27),
			084=>array(084,"Utopia",2.27),
			085=>array(085,"Caslon",1.52),
			086=>array(086,"Monotype.com",1.52),
			087=>array(087,"Algerian",0.76), */
			088=>array(088,"Zapf Chancery",0.76)
		); 
		
		$unixfonts=array(
			000=>array(000,"DejaVu Sans Mono",92.00),
			001=>array(001,"Bitstream Charter",90.00),
			002=>array(002,"URW Chancery L",89.46),
			003=>array(003,"Nimbus Mono L",89.19),
			004=>array(004,"Century Schoolbook L",88.65),
			005=>array(005,"URW Gothic L",87.30),
			006=>array(006,"URW Bookman L",83.78),
			007=>array(007,"Nimbus Sans L",83.33),
			008=>array(008,"URW Palladio L",82.70),
			009=>array(009,"Bitstream Vera Sans Mono",81.25),
			010=>array(010,"DejaVu Sans",80.00),
			011=>array(011,"DejaVu Sans Condensed",80.00),
			012=>array(012,"Bitstream Vera Sans",79.08),
			013=>array(013,"DejaVu Serif Condensed",78.00),
			014=>array(014,"Nimbus Roman No9 L",77.84),
			015=>array(015,"Courier",74.32),
			016=>array(016,"Bitstream Vera Serif",68.75),
			017=>array(017,"Arial",63.24),
			018=>array(018,"Courier New",62.43),
			019=>array(019,"DejaVu Serif",61.67),
			020=>array(020,"FreeMono",61.67),
/*			021=>array(021,"FreeSerif",61.67),
			022=>array(022,"Utopia",60.54),
			023=>array(023,"FreeSans",58.33),
			024=>array(024,"Helvetica",58.11),
			025=>array(025,"Times New Roman",57.30),
			026=>array(026,"Verdana",55.14),
			027=>array(027,"Arial Black",54.32),
			028=>array(028,"Impact",53.78),
			029=>array(029,"Georgia",53.24),
			030=>array(030,"Liberation Mono",52.00),
			031=>array(031,"Liberation Sans",52.00),
			032=>array(032,"Liberation Serif",52.00),
			033=>array(033,"Comic Sans MS",51.89),
			034=>array(034,"Trebuchet MS",51.35),
			035=>array(035,"Andale Mono",50.27),
			036=>array(036,"Fixed",50.27),
			037=>array(037,"Times",49.46),
			038=>array(038,"New Century Schoolbook",47.57), */
			039=>array(039,"MgOpen Canonica",46.00)
		);
		return array($msfonts,$applefonts,$unixfonts);
	}
	private function getStackString($stackname) {
		$stacks=array(
			"arial"=>array(array(0,6)),
			"verdana"=>array(array(0,5),array(2,10)),
			"times"=>array(array(1,16),array(2,14)),
			"arial_black"=>array(array(1,4),array(2,17)),
			"impact"=>array(array(1,21),array(2,11)),
			"arial_narrow"=>array(array(2,12),array(2,11)),
			"courier"=>array(array(0,7),array(1,2),array(2,18),array(2,0)),
			// last one:			
			"basic_sans_serif"=>array(array(0,0),array(1,0),array(2,10),array(2,3))
		);
		if (!isset($stacks[$stackname]))
			throw new exception("unknown font stack name:  $stackname");
		$fnames=$this->getFacenameArrays();
		infolog_dump("css","fnames",$fnames);
		$stack=$stacks[$stackname];
		infolog_dump("css","stack",$stack);
		$retval="";
		foreach ($stack as $s) {
			infolog("css","setting font to {$s[0]}, {$s[1]}");
			$comma=$retval != "" ? "," : "";
			$retval .= $comma.$fnames[$s[0]][$s[1]][1];
		}
		return $retval;	
	}
	
	public function cssOutput($browser) {
		$stackstring=$this->getStackString($this->initstring);
		return array("font-family",$stackstring);
	}		
}
?>
